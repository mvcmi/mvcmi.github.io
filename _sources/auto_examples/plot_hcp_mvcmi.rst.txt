
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/plot_hcp_mvcmi.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_plot_hcp_mvcmi.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_plot_hcp_mvcmi.py:


=====================
Run MVCMI on HCP data
=====================

This example demonstrates how to run MVCMI on
pre-processed HCP data.

.. GENERATED FROM PYTHON SOURCE LINES 9-13

.. code-block:: Python


    # Authors: Padma Sundaram
    #          Mainak Jas








.. GENERATED FROM PYTHON SOURCE LINES 14-15

we will first load the necessary modules

.. GENERATED FROM PYTHON SOURCE LINES 15-27

.. code-block:: Python

    import numpy as np
    import matplotlib.pyplot as plt

    from mvcmi import compute_cmi, compute_ccoef_pca, reduce_dim
    from mvcmi.datasets import fetch_hcp_sample, load_label_ts

    from joblib import Parallel, delayed

    n_jobs = 1 # number of cores to use when running PCA in parallel
    n_parcels = 10 # just to make example run faster
    dim_red = 0.95








.. GENERATED FROM PYTHON SOURCE LINES 28-29

load the preprocessed data

.. GENERATED FROM PYTHON SOURCE LINES 29-34

.. code-block:: Python

    data_path = fetch_hcp_sample()

    label_ts_fname = data_path / 'label_ts.npz'
    label_ts = load_label_ts(label_ts_fname, n_parcels=n_parcels)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    done reading in label_ts

    167





.. GENERATED FROM PYTHON SOURCE LINES 35-36

reduce dimensionality using PCA

.. GENERATED FROM PYTHON SOURCE LINES 36-46

.. code-block:: Python

    n_times = label_ts[0].shape[1] 

    min_dim = 2
    max_dim = n_times - 15

    parcel_sizes = [None] * len(label_ts)
    label_ts_red = Parallel(n_jobs=n_jobs, verbose=4)(delayed(reduce_dim)(
        this_ts, dim_red=dim_red, min_dim=min_dim, max_dim=max_dim, n_use=n_use)
        for this_ts, n_use in zip(label_ts, parcel_sizes))








.. GENERATED FROM PYTHON SOURCE LINES 47-48

do the actual CMI computation

.. GENERATED FROM PYTHON SOURCE LINES 48-51

.. code-block:: Python

    print ("computing cmi")
    cmimtx = compute_cmi(label_ts_red)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    computing cmi
    mvcon compute_cmi
    mvcon partial_corr_mvar
    (1633, 1200)
    (11,)
    0
    1
    2
    3
    4
    5
    6
    7
    8
    9
    mvcon cmui_from_pcor_mvar
    /Users/mainak/Desktop/github_repos/mvcmi/mvcmi/algo.py:70: RuntimeWarning: invalid value encountered in log
      cmui[ii, jj] = -0.5 * np.sum(np.log(1 - s[0:n]))




.. GENERATED FROM PYTHON SOURCE LINES 52-53

compare to correlation coefficient

.. GENERATED FROM PYTHON SOURCE LINES 53-56

.. code-block:: Python

    print ("computing sccoef_pca")
    corrmtx = compute_ccoef_pca(label_ts_red)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    computing sccoef_pca




.. GENERATED FROM PYTHON SOURCE LINES 57-58

plot the CMI matrix

.. GENERATED FROM PYTHON SOURCE LINES 58-61

.. code-block:: Python

    plt.imshow(cmimtx)
    plt.colorbar()




.. image-sg:: /auto_examples/images/sphx_glr_plot_hcp_mvcmi_001.png
   :alt: plot hcp mvcmi
   :srcset: /auto_examples/images/sphx_glr_plot_hcp_mvcmi_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.colorbar.Colorbar object at 0x7fe3581ca790>



.. GENERATED FROM PYTHON SOURCE LINES 62-63

plot the correlation matrix

.. GENERATED FROM PYTHON SOURCE LINES 63-67

.. code-block:: Python

    plt.figure()
    plt.imshow(corrmtx)
    plt.colorbar()




.. image-sg:: /auto_examples/images/sphx_glr_plot_hcp_mvcmi_002.png
   :alt: plot hcp mvcmi
   :srcset: /auto_examples/images/sphx_glr_plot_hcp_mvcmi_002.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.colorbar.Colorbar object at 0x7fe3dc8d82b0>




.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 48.304 seconds)


.. _sphx_glr_download_auto_examples_plot_hcp_mvcmi.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_hcp_mvcmi.ipynb <plot_hcp_mvcmi.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_hcp_mvcmi.py <plot_hcp_mvcmi.py>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
